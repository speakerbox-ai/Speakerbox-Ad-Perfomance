<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speakerbox Weekly Ad Performance Report</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for creating graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the report */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* A light gray background */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header Section -->
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Speakerbox Ad Performance Report</h1>
            <p class="text-gray-500 mt-2">An interactive summary of weekly advertising campaigns.</p>
        </header>

        <!-- Key Metrics Summary Cards -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="card p-6 flex flex-col justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-gray-500">Total Amount Spent</h2>
                    <p id="totalSpent" class="text-4xl font-bold text-gray-800 mt-2">₹0</p>
                </div>
                <p class="text-sm text-gray-400 mt-4">Across all 6 weeks</p>
            </div>
            <div class="card p-6 flex flex-col justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-gray-500">Total Leads</h2>
                    <p id="totalLeads" class="text-4xl font-bold text-gray-800 mt-2">0</p>
                </div>
                 <p class="text-sm text-gray-400 mt-4">Excludes conversations</p>
            </div>
            <div class="card p-6 flex flex-col justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-gray-500">Total Qualified Leads</h2>
                    <p id="totalQualifiedLeads" class="text-4xl font-bold text-gray-800 mt-2">0</p>
                </div>
                 <p class="text-sm text-gray-400 mt-4">Sum of all qualified leads</p>
            </div>
            <div class="card p-6 flex flex-col justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-gray-500">Average Cost Per Result</h2>
                    <p id="avgCpr" class="text-4xl font-bold text-gray-800 mt-2">₹0</p>
                </div>
                 <p class="text-sm text-gray-400 mt-4">Average across all 6 weeks</p>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="card p-6">
            <h2 class="text-xl font-bold text-gray-700 mb-4">Weekly Performance Breakdown</h2>
            <div class="h-96">
                 <canvas id="performanceChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // --- DATA INITIALIZATION ---
        // The raw data provided for the ad reports.
        const reportData = [
            { week: 'July 20 - 27', spent: 2600, leads: 37, cpr: 70, qualifiedLeads: 1 },
            { week: 'July 27 - Aug 3', spent: 2078, leads: 36, cpr: 57, qualifiedLeads: 0 },
            { week: 'Aug 3 - 10', spent: 2600, leads: 33, cpr: 53, conversations: 16, qualifiedLeads: 7 },
            { week: 'Aug 10 - 17', spent: 1825, leads: 14, cpr: 130, qualifiedLeads: 3 },
            { week: 'Aug 17 - 24', spent: 1813, leads: 12, cpr: 151, qualifiedLeads: null },
            { week: 'Aug 24 - 31', spent: 2259, leads: 32, cpr: 70, qualifiedLeads: null }
        ];

        // --- CALCULATE KEY METRICS ---
        // Calculate the totals and averages to display in the summary cards.
        const totalSpent = reportData.reduce((sum, item) => sum + item.spent, 0);
        const totalLeads = reportData.reduce((sum, item) => sum + item.leads, 0);
        const totalQualifiedLeads = reportData.reduce((sum, item) => sum + (item.qualifiedLeads || 0), 0);
        const avgCpr = reportData.reduce((sum, item) => sum + item.cpr, 0) / reportData.length;

        // --- UPDATE METRIC CARDS IN THE UI ---
        // Set the text content of the summary cards with the calculated values.
        document.getElementById('totalSpent').textContent = `₹${totalSpent.toLocaleString('en-IN')}`;
        document.getElementById('totalLeads').textContent = totalLeads.toLocaleString('en-IN');
        document.getElementById('totalQualifiedLeads').textContent = totalQualifiedLeads.toLocaleString('en-IN');
        document.getElementById('avgCpr').textContent = `₹${avgCpr.toFixed(2)}`;

        // --- CHART CONFIGURATION AND RENDERING ---
        const ctx = document.getElementById('performanceChart').getContext('2d');
        const performanceChart = new Chart(ctx, {
            type: 'bar', // The base chart type is a bar chart.
            data: {
                labels: reportData.map(d => d.week), // Labels for the X-axis (weekly periods)
                datasets: [
                    {
                        label: 'Amount Spent (₹)',
                        data: reportData.map(d => d.spent),
                        backgroundColor: 'rgba(59, 130, 246, 0.5)', // Blue bars
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1,
                        yAxisID: 'y', // Assign to the primary Y-axis
                        order: 2 
                    },
                    {
                        label: 'Total Leads',
                        data: reportData.map(d => d.leads),
                        backgroundColor: 'rgba(16, 185, 129, 0.6)', // Green bars
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 1,
                        yAxisID: 'y', // Assign to the primary Y-axis
                        order: 3
                    },
                     {
                        label: 'Qualified Leads',
                        data: reportData.map(d => d.qualifiedLeads),
                        backgroundColor: 'rgba(249, 115, 22, 0.6)', // Orange bars
                        borderColor: 'rgba(249, 115, 22, 1)',
                        borderWidth: 1,
                        yAxisID: 'y',
                        order: 4
                    },
                    {
                        label: 'Cost Per Result (₹)',
                        data: reportData.map(d => d.cpr),
                        type: 'line', // This dataset will be rendered as a line chart
                        borderColor: 'rgba(239, 68, 68, 1)', // Red line
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        tension: 0.3, // Makes the line slightly curved
                        fill: false,
                        yAxisID: 'y1', // Assign to the secondary Y-axis
                        order: 1 // Render on top
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index', // Show tooltips for all datasets at the same x-index
                    intersect: false,
                },
                scales: {
                    x: {
                        grid: {
                            display: false // Hide vertical grid lines for a cleaner look
                        }
                    },
                    y: { // Primary Y-axis for Amount Spent and Leads
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                            display: true,
                            text: 'Amount Spent (₹) / Total Leads'
                        },
                        grid: {
                            color: '#e5e7eb' // Lighter grid lines
                        }
                    },
                    y1: { // Secondary Y-axis for CPR
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: {
                            display: true,
                            text: 'Cost Per Result (₹)'
                        },
                        grid: {
                            drawOnChartArea: false, // Only show grid lines for the primary axis
                        },
                    }
                },
                plugins: {
                    tooltip: {
                        backgroundColor: '#1f2937',
                        titleFont: { size: 16 },
                        bodyFont: { size: 14 },
                        padding: 12,
                        cornerRadius: 6,
                        // Custom tooltip callback to handle special cases
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    // Add a Rupee symbol for currency values
                                    if (context.dataset.label.includes('₹')) {
                                        label += new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(context.parsed.y);
                                    } else {
                                        label += context.parsed.y;
                                    }
                                } else {
                                    return label + 'N/A';
                                }
                                // Add conversation info for the specific week
                                if (context.dataset.label === 'Total Leads' && context.dataIndex === 2) {
                                   const conversations = reportData[context.dataIndex].conversations;
                                   return [label, `  (+ ${conversations} conversations)`];
                                }
                                return label;
                            }
                        }
                    },
                    legend: {
                        position: 'bottom', // Place the legend at the bottom
                        labels: {
                            padding: 20,
                            font: {
                                size: 14
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>

